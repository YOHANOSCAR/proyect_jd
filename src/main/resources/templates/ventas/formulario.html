<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layout}"
><head>
    <title>Formulario de Venta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<section layout:fragment="contenido">
<div class="container mt-5">
    <h1>Formulario de Venta</h1>
    <form th:action="@{/ventas}" th:object="${transaccion}" method="post">
        <!-- Cliente -->
        <div class="mb-3">
            <label for="cliente" class="form-label">Cliente</label>
            <select id="cliente" name="cliente.id" class="form-select" required>
                <option value="" disabled selected>Seleccione un cliente</option>
                <option th:each="cliente : ${clientes}" th:value="${cliente.id}" th:text="${cliente.nombre}"></option>
            </select>
        </div>

        <!-- Tipo de Transacción -->
        <div class="mb-3">
            <label for="tipo" class="form-label">Tipo de Transacción</label>
            <select id="tipo" name="tipo" class="form-select" required>
                <option value="" disabled selected>Seleccione un tipo</option>
                <option th:each="tipo : ${tiposTransaccion}" th:value="${tipo}" th:text="${tipo}"></option>
            </select>
        </div>

        <!-- Estado de Transacción -->
        <div class="mb-3">
            <label for="estado" class="form-label">Estado de Transacción</label>
            <select id="estado" name="estado" class="form-select" required>
                <option value="" disabled selected>Seleccione un estado</option>
                <option th:each="estado : ${estadosTransaccion}" th:value="${estado}" th:text="${estado}"></option>
            </select>
        </div>

        <!-- Productos -->
        <div class="mb-3">
            <label for="productos" class="form-label">Productos</label>
            <div id="productos-container">
                <div class="row mb-2" th:each="producto : ${productos}">
                    <div class="col-md-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" th:id="'producto-' + ${producto.id}" th:name="productoId" th:value="${producto.id}">
                            <label class="form-check-label" th:for="'producto-' + ${producto.id}" th:text="${producto.nombre}"></label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <input type="number" class="form-control" th:name="'cantidades[' + ${producto.id} + ']'" placeholder="Cantidad" min="1">
                    </div>
                    <div class="col-md-4">
                        <input type="number" class="form-control" th:name="'precios[' + ${producto.id} + ']'" placeholder="Precio Unitario" step="0.01" min="0">
                    </div>
                </div>
            </div>
        </div>

        <!-- Vendedor -->
        <input type="hidden" name="vendedor.id" th:value="${transaccion.vendedor.id}"/>

        <!-- Notas -->
        <div class="mb-3">
            <label for="notas" class="form-label">Notas</label>
            <textarea id="notas" name="notas" class="form-control"></textarea>
        </div>

        <!-- Botón Guardar -->
        <button type="submit" class="btn btn-primary">Guardar</button>
    </form>
</div>
</section>
</body>
</html>
